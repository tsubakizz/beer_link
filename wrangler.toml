#:schema node_modules/wrangler/config-schema.json

# ========================================
# Cloudflare Workers 設定
# ========================================
name = "beer-link-staging"
main = ".open-next/worker.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# 静的アセット
[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# カスタムドメイン (staging)
routes = [
  { pattern = "staging.beer-link.com", custom_domain = true }
]

# 公開する環境変数
[vars]
NEXT_PUBLIC_SITE_URL = "https://staging.beer-link.com"
NEXT_PUBLIC_R2_PUBLIC_URL = "https://pub-cdb979a7c5384512a98ac2106b339f21.r2.dev"
NEXT_PUBLIC_R2_ASSETS_URL = "https://pub-cc459d1800fc49b793f5669f940edb77.r2.dev"
NEXT_PUBLIC_SUPABASE_URL = "https://ywldjjuajjuabdenlylo.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY = "sb_publishable_e17vZYTMCHGnJaKXkVBJ_Q_gFNKRarH"

# R2 バケットの紐付け
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "beer-link-staging-public"

# Hyperdrive (データベース接続)
[[hyperdrive]]
binding = "HYPERDRIVE"
id = "7b4a4640e7ea42d0afef173747d26cf2"

# ログ出力 (staging)
[observability]
enabled = true

# ========================================
# 本番環境
# ========================================
[env.production]
name = "beer-link-production"

# カスタムドメイン (production)
routes = [
  { pattern = "beer-link.com", custom_domain = true },
  { pattern = "www.beer-link.com", custom_domain = true }
]

[env.production.vars]
NEXT_PUBLIC_SITE_URL = "https://beer-link.com"
NEXT_PUBLIC_R2_PUBLIC_URL = "https://r2.beer-link.com"
NEXT_PUBLIC_R2_ASSETS_URL = "https://r2-assets.beer-link.com"
NEXT_PUBLIC_SUPABASE_URL = "https://dzxlhatxlpspjhzmipeh.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY = "sb_publishable_HlSP-NOxzMpYRguIEA1e7Q_8IefLKy2"

[[env.production.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "beer-link-production-public"

[[env.production.hyperdrive]]
binding = "HYPERDRIVE"
id = "324279092e4f467395948dd8fd689c7c"

# ログ出力 (production)
[env.production.observability]
enabled = true
